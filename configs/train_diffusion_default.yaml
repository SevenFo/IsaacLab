# LeRobot Training Configuration - Diffusion Policy
# Example showing diffusion policy configuration

dataset:
  repo_id: "lerobot/pressed_grasp_spanner"
  root: "./assets"

policy:
  type: "diffusion"  # Use diffusion policy instead of ACT
  device: "cuda:1"
  repo_id: "my-robot/diffusion-pressed-grasp-default"  # Required for model hub
  
  # Diffusion-specific parameters
  n_obs_steps: 2
  horizon: 16  # Diffusion horizon
  n_action_steps: 8
  
  # Diffusion model parameters
  num_inference_steps: 10
  clip_sample: true
  clip_sample_range: 1.0
  prediction_type: "epsilon"
  beta_schedule: "squaredcos_cap_v2"
  beta_start: 0.0001
  beta_end: 0.02
  noise_scheduler_type: "DDPM"
  num_train_timesteps: 100
  
  # Model architecture
  down_dims: [512, 1024, 2048]
  kernel_size: 5
  n_groups: 8
  diffusion_step_embed_dim: 128
  use_film_scale_modulation: true
  
  # Vision backbone
  vision_backbone: "resnet18"
  crop_shape: [84, 84]
  crop_is_random: true
  pretrained_backbone_weights: null  # Use default ResNet weights
  use_group_norm: true
  spatial_softmax_num_keypoints: 32
  
  # Training parameters
  use_amp: false
  do_mask_loss_for_padding: false
  drop_n_last_frames: 7

training:
  output_dir: "outputs/train/diffusion_pressed_grasp"
  steps: 30000
  batch_size: 32  # Smaller batch for diffusion
  num_workers: 4
  
  log_freq: 100
  save_freq: 5000
  eval_freq: 0

# Use policy preset for optimal settings
optimizer:
  use_policy_training_preset: true

wandb:
  enable: false
